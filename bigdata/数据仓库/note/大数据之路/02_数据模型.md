# 一、大数据领域建模综述

## 1.1、为什么需要数据建模

有了适合业务和基础数据存储环境的模型，那么大数据就能获得以下好处。

- 性能:良好的数据模型能帮助我们快速查询所需要的数据，减少数据的I/O吞吐。
- 成本:良好的数据模型能极大地减少不必要的数据冗余，也能实现计算结果复用，极大地降低大数据系统中的存储和计算成本。
- 效率:良好的数据模型能极大地改善用户使用数据的体验，提高使用数据的效率。
- 质量:良好的数据模型能改善数据统计口径的不一致性，减少数据计算错误的可能性。

大数据系统需要数据模型方法来帮助**更好地组织和存储数据，以便在性能、成本、效率和质量之间取得最佳平衡**。

## 1.2、从OLTP和OLAP系统的区别看模型方法论的选择

OLTP系统通常面向的主要数据操作是随机读写，主要采用满3NF的实体关系模型存储数据，从而在事务处理中解决数据的冗余和一致性问题；而OLAP系统面向的主要数据操作是批量读写，事务处理一致性不是OLAP关注的，其主要关注**数据的整合，以及在一次性复杂大数据查询和处理中的性能**，因此它需要采用一些不同的数据建模方法。

## 1.3、典型的数据仓库建模方法论
### 1.3.1、ER模型
数据仓库之父Bill Inmon提出的建模方法是从全企业的高度设计一个3NF模型，用实体关系（Entity Relationship, ER）模型描述企业业务，在范式理论上符合3NF。数据仓库中的3NF与OLTP系统中的3NF的区别在于，它是站在企业角度面向主题的抽象，而不是针对某个具体业务流程的实体对象关系的抽象。其具有以下几个特点：
- 需要全面了解企业业务和数据
- 实施周期非常长
- 对建模人员的能力要求非常高

采用ER模型建设数据仓库模型的出发点是整合数据，将各个系统中的数据以整个企业角度按主题进行相似性组合和合并，并进行一致性处理，为数据分析决策服务，但是并不能直接用于分析决策。
其建模步骤分为三个阶段。
- 高层模型:一个高度抽象的模型，描述主要的主题以及主题间的关系，用于描述企业的业务总体概况。
- 中层模型:在高层模型的基础上，细化主题的数据项。
- 物理模型（也叫底层模型）:在中层模型的基础上，考虑物理存储，同时基于性能和平台特点进行物理属性的设计，也可能做一些表的合并、分区的设计等。

ER 模型在实践中最典型的代表是Teradata公司基于金融业务发布的FS-LDM(Financial Services Logical Data Model)，它通过对金融业务的高度抽象和总结，将金融业务划分为10大主题，并以设计面向金融仓库模型的核心为基础，企业基于此模型做适当调整和扩展就能快速落地实施。

### 1.3.2、维度模型
维度模型是数据仓库领域的Ralph Kimball大师所倡导的，他的The Data Wrehouse Toolkit-The Complete Guide to Dimensional Modeling是数据仓库工程领域最流行的数据仓库建模的经典。
维度建模**从分析决策的需求出发构建模型**，为分析需求服务，因此它**重点关注用户如何更快速地完成需求分析，同时具有较好的大规模复杂查询的响应性能**。其典型的代表是星形模型，以及在一些特殊场景下使用的雪花模型。
其设计分为以下几个步骤。
- **选择需要进行分析决策的业务过程**。业务过程可以是单个业务事件，比如交易的支付、退款等；也可以是某个事件的状态，比如当前的账户余额等；还可以是一系列相关业务事件组成的业务流程，具体需要看我们分析的是某些事件发生情况，还是当前状态，或是事件流转效率。
- **选择粒度**。在事件分析中，我们要预判所有分析需要细分的程度，从而决定选择的粒度。粒度是维度的一个组合。
- **认识维表**：选择好粒度之后，就需要基于此粒度设计维表，包括维度属性，用于分析时进行分组和筛选。
- **选择事实**：确定分析需要衡量的指标。

在不太成熟、快速变化的业务面前，构建ER模型的风险非常大，不太适合去构建ER模型。

### 1.3.3、Data Vault模型

### 1.3.4、Anchor模型

# 二、数据整合以及管理体系
## 2.1、概述
大数据系统建设不断追求的方向：对数据进行有序和有结构地分类组织和存储，避免重复建设和数据不一致性，保证数据的规范性。
大数据建设的核心是：：从业务架构设计到模型设计，从数据研发到数据服务，做到数据可管理 、可追溯、可规避重复建设。
### 2.1.1、定位及价值
建设统一的、规范化的数据接入层（ODS）和数据中间层（DWD、DWS），通过数据服务和数据产品，完成大数据系统建设 ，即数据公共层建设。提供标准化的（Standard）、共享的（Shared）、数据服务（Service）能力，降低数据互通成本，释放计算、存储、人力等资源，以消除业务和技术之痛。
### 2.1.2、体系架构















# 三、维度设计

# 四、事实表设计
